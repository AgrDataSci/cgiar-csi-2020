<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Machine Learning with Metadata and Experimental Citizen Science in R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Kauê de Sousa" />
    <meta name="date" content="2020-03-01" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/leaflet/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet/leaflet.js"></script>
    <link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
    <script src="libs/Proj4Leaflet/proj4-compressed.js"></script>
    <script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding/leaflet.js"></script>
    <script src="libs/leaflet-providers/leaflet-providers_1.9.0.js"></script>
    <script src="libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
    <link href="libs/HomeButton/home-button.css" rel="stylesheet" />
    <script src="libs/HomeButton/home-button.js"></script>
    <script src="libs/HomeButton/easy-button-src.min.js"></script>
    <link href="libs/PopupTable/popup.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Machine Learning with Metadata and Experimental Citizen Science in R
### Kauê de Sousa
### 2020-03-01

---





# Content
--

* Some concepts

--

* Our workflow

--

* A case study with tricot (*triadic comparison of technologies*)

--
* A case study with meta-analysis 

---
# What is machine learning?

.pull-left[
**Machine learning** (ML) is the scientific study of algorithms and statistical models that computer systems use to perform a specific task without using explicit instructions, relying on patterns and inference instead. ML algorithms build a mathematical model based on sample data, known as "training data", in order to make predictions or decisions [1,2].

&lt;img src="img/ML-eve.png" width="55%"/&gt;

]
.footnote[
[1] [Wikipedia](https://en.wikipedia.org/wiki/Machine_learning)
[2] [James et al. 2013](https://doi.org/10.1007/978-1-4614-7138-7)
]

--
.pull-right[
&lt;img src="img/ML-type.png" width="80%"/&gt;
]

---
# Recursive partitioning trees (rpart)

**Recursive partitioning** is a ML method for classification. It creates a decision tree that strives to correctly classify members of the population by splitting it into sub-populations where the feature space is recursively split into regions containing observations with similar response values[1]


We use **model-based recursive partitioning** which is a variant of **rpart** with the idea to partition the feature space to identify groups of subjects with similar values of the parameters of a model of interest[2]

&lt;center&gt;
&lt;img src="img/rpart.png" width="40%"/&gt;
&lt;/center&gt;

.footnote[
[1] [Strobl et al. 2009](http://dx.doi.org/10.1037/a0016973)
[2] [Zeileis et al. 2012](https://doi.org/10.1198/106186008X319331)
]
---
# How it works

--
1. Fit a model to the full data.

--

2. Assess the stability of the worth parameters with respect to each covariate. That is, test for a structural change in the dependent variable to the first derivatives of the log-likelihood, when these contributions are ordered by covariate values

--

3. If there is significant instability, split the full data by the covariate with the strongest instability, using the cut-point that gives the highest improvement in model fit

--

4. Repeat steps 1-3 for each subgroup until there are no more significant instabilities, or a split produces a subgroup below a given size threshold[1]

.footnote[
[1] [Turner et al. 2020](https://doi.org/10.1007/s00180-020-00959-3)
]
---
# Forward and cross-validation

**Forward selection** is a type of stepwise regression which begins with an empty model and adds in variables one by one. In each forward step, you add the one variable that gives the single best improvement to your model.

**Cross-validation** is a resampling procedure used to evaluate ML models on a limited data sample. 

&lt;center&gt;
&lt;img src="img/cross-validation.png" width="60%"/&gt;
&lt;/center&gt;
---

# Citizen science

Scientific research carried out, at least in part, by non-professional scientists

&lt;center&gt;
&lt;img src="img/citizen-science.png" width="60%"/&gt;
&lt;/center&gt;

---
# Triadic comparison of technologies

&lt;img src="img/tricot-randomised.png" width = "80%"/&gt;

.foot-note[
[van Etten (2019a)](https://doi.org/10.1017/S0014479716000739)
]

---
class: middle, inverse
# How we apply these methods

---
# Workflow
.pull-left[
&lt;img src="img/workflow.png" width="120%"/&gt;
]
--
(**A**) Several participants contribute with small tasks. All data is combined using rankings.

--

(**B**) Explanatory variables are added (e.g. using lonlat and planting dates, or even DNA markers)

--

(**C**) Model selection to find the variables that best explain the data

--

(**D**) Automated reports can be generated and feedback to participants in (**A**) is given

--

(**E**) A stable *rpart* is used for further analysis

---
class: middle
# R packages that we developed to support this workflow:
&lt;img src="img/PlackettLuce.png" width="10%" style="float:left"/&gt;&amp;nbsp; &lt;img src="img/gosset.png" width="10%" style="float:left"/&gt;&amp;nbsp; &lt;img src="img/climmobtools.png" width="10%" style="float:left"/&gt;&amp;nbsp; &lt;img src="img/chirps.png" width="10%" style="float:left"/&gt;&amp;nbsp; &lt;img src="img/climatrends.png" width="10%" style="float:left"/&gt;&amp;nbsp; 

---

class: middle, inverse
# Now to the hands-on part!

---

class: middle
# Common beans in Niragua with the *tricot* method

---
# We are going to use these packages

```r
library("readr")
library("PlackettLuce")
library("qvcalc")
library("gosset")
library("ggplot2")
library("abind")
library("foreach")
library("doParallel")
source("script/functions.R")
```

---
# This is how the beans data looks like


```r
dt &lt;- read_csv("data/commonbeans_tricot.csv")
```


```r
head(dt)
```

```
## # A tibble: 6 x 21
##   package variety_a variety_b variety_c best  worst var_a var_b var_c   lon
##   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 paquet… INTA Rojo PM2 Don … INTA Fer… C     A     Worse Worse Bett… -85.7
## 2 paquet… BRT 103-… INTA Mat… PM2 Don … A     B     Bett… Worse Worse -85.4
## 3 paquet… ALS 0532… INTA Fer… SJC 730-… B     A     Worse Worse Worse -85.4
## 4 paquet… INTA Rojo INTA Cen… INTA Pre… C     A     Worse Worse Bett… -85.4
## 5 paquet… SJC 730-… INTA Mat… INTA Fer… B     A     Worse Bett… Bett… -85.4
## 6 paquet… INTA Rojo ALS 0532… INTA Cen… B     C     Worse Bett… Worse -85.4
## # … with 11 more variables: lat &lt;dbl&gt;, planting_date &lt;dbl&gt;, planting_day &lt;dbl&gt;,
## #   season &lt;chr&gt;, year &lt;dbl&gt;, GDD &lt;dbl&gt;, minNT &lt;dbl&gt;, maxNT &lt;dbl&gt;, MLDS &lt;dbl&gt;,
## #   MLWS &lt;dbl&gt;, Rx5day &lt;dbl&gt;
```

---

842 plot trials in 5 seasons


```r
plot_map(dt, c("lon","lat"), map.types = "OpenTopoMap")
```

<div id="htmlwidget-b2455a30160821ae0fbe" style="width:504px;height:504px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-b2455a30160821ae0fbe">{"x":{"options":{"minZoom":1,"maxZoom":100,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["OpenTopoMap",1,"OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[13.13832845,13.3308301,13.3294938,13.33216638,13.33216638,13.3308301,13.32815751,13.33216638,13.33617519,13.3308301,13.33216638,13.33617519,13.33216638,13.19449046,13.19850154,13.2065235,13.17710836,13.18111972,12.9028437,13.19983855,13.13598809,12.89213455,13.15571331,13.33701035,13.33751144,13.33701035,13.33851363,13.3378455,13.33670084,13.13598809,13.13765978,13.13732544,13.33567409,13.13732544,13.14100313,13.12896687,13.13565375,13.13765978,13.13782695,13.13832845,13.14501508,13.13966579,13.14501508,13.13832845,13.13882996,13.14100313,13.13632243,13.13749261,13.13632243,13.14367777,13.13431639,13.13749261,13.13816129,13.33667628,13.13632243,13.13615526,13.12896687,13.13565375,13.17175977,13.14100313,13.33617519,13.33483892,13.13598809,13.2205613,12.88142494,13.13615526,13.14100313,13.13498507,13.13414922,13.13582092,13.13531941,13.13331336,13.13531941,13.13348053,13.13331336,13.33300155,13.33517299,13.33617519,13.33467189,13.32414856,13.33183231,13.33617519,13.33166527,13.33567409,13.33250045,13.33483892,13.3308301,13.33233341,13.33250045,13.33300155,13.33433782,13.33216638,13.33534002,13.3268212,13.33483892,13.3294938,13.33366969,13.3308301,13.33751144,13.33617519,13.33670084,13.33383672,13.3294938,13.33350266,13.3294938,13.33216638,13.33350266,12.91489095,13.33500596,13.33216638,13.33350266,13.33350266,13.33483892,13.33350266,13.33383672,13.33567409,13.33350266,12.87874746,13.33350266,13.33216638,13.32815751,13.33483892,13.18379393,13.15170153,13.2720263,13.21721904,13.19716452,13.20117556,13.14902697,13.19716452,13.26434066,13.14902697,13.18914226,13.20117556,13.33670084,13.33670084,13.33670084,13.33670084,13.33670084,13.1958275,13.33350266,13.34152016,13.07221862,13.34018393,13.33884769,13.33751144,13.34152016,13.33500596,13.33670084,13.33650925,13.33670084,13.33500596,13.33670084,13.33650925,13.33884769,13.20117556,13.33717738,13.33667628,13.33670084,13.33717738,13.33567409,13.22791411,13.33767847,13.3383466,13.33767847,13.33634222,13.33283452,13.33517299,13.33584112,13.33884769,13.33600815,13.33884769,13.33617519,13.13699111,13.33884769,13.33584112,13.33617519,13.33483892,13.33751144,13.1394293,13.1364896,13.15838779,12.88410238,12.88878766,13.13765978,12.9135524,13.33751144,13.12361723,12.88410238,13.34018393,13.33884769,13.1393151,13.33483892,13.18245683,12.90150508,12.89213455,13.33483892,13.33751144,13.33884769,13.33884769,13.33483892,13.19449046,13.33617519,13.33751144,13.33884769,13.33670084,13.3308301,13.33884769,13.33884769,13.33670084,13.33884769,13.45106599,13.01392405,13.13164164,12.96307414,13.21187133,13.13431639,13.33670084,13.18245683,13.15170153,12.8854411,13.1958275,13.18513102,13.36957933,13.20117556,13.20786047,13.1394293,13.13699111,12.90819811,12.90418232,13.13966579,13.14100313,13.18646811,13.13699111,13.20117556,13.21187133,13.17710836,13.19315342,13.20786047,13.2065235,13.33670084,13.07221862,13.20518653,13.33670084,13.33684331,13.13030426,13.33670084,13.3874407,13.07221862,13.33670084,13.21989285,13.20919743,13.13030426,13.1530388,13.3845868,13.14100313,13.17844549,13.3846236,13.21053438,13.14367777,13.33670084,13.25598643,13.43637372,13.1394295,13.1394295,13.1393608,13.13966579,13.33670084,13.16641107,13.1393608,13.33483892,13.33670084,13.23459829,13.13331336,13.18914226,13.13164164,13.21855595,13.31746685,13.33701035,13.33584112,13.17042261,13.26601147,13.18780519,13.19850154,13.13164164,13.13832845,13.33550706,13.38735,13.18111972,13.24061389,13.20786047,13.3846113,13.17844549,12.91489095,13.17443408,13.13297902,13.13431639,13.1393608,12.89882782,13.08482887,13.17577122,13.1394293,13.09552972,13.22323507,12.89213455,12.68723422,12.68723422,12.68723422,12.68723422,12.68723422,12.81922178,12.68723422,12.68723422,12.68723422,12.81912483,12.79573159,13.08416006,12.81581859,13.08382565,12.82920903,13.08449447,12.71268839,13.09285455,12.71938643,12.73010293,12.79465086,12.83188703,12.72474474,12.73814001,12.73278198,12.83456501,12.82385294,12.81180132,12.8144795,13.08449447,12.69125347,13.08365844,12.83117152,13.09168416,13.02195203,12.73814001,12.81180132,13.09268735,13.08650091,12.66445728,12.73278198,12.83420299,12.81314041,12.8198358,12.71938643,12.83724295,13.08700252,12.81922178,12.93362997,12.8106296,12.72742385,12.82385294,12.81922178,12.79961801,13.09285455,12.73546101,12.83791244,12.81180132,12.79707077,12.8091231,12.83054803,12.81922178,12.89347322,12.83054803,13.08516328,12.8225139,12.8225139,12.81180132,12.7943924,12.80123295,12.826531,13.09218576,12.7394795,12.81581859,12.82519197,12.81581859,12.72876339,12.73010293,12.71134876,12.73546101,12.88142494,12.83539486,12.83456501,12.73010293,12.85197115,12.80242743,13.07221862,12.71402801,12.72876339,12.90819811,12.74483738,12.84661554,13.02997975,12.71804684,12.7260843,12.72742385,12.8800862,12.86937608,12.94299894,12.81314041,12.79974912,12.82385294,12.91489095,12.7341215,12.82787002,12.79707077,12.87740872,12.82385294,12.80348018,12.83992087,12.94433734,12.71134876,12.81922178,12.89213455,12.71268839,12.8881185,12.72742385,12.84393769,13.07221862,12.8198358,12.85464891,12.87874746,13.00321967,12.89882782,12.81715766,12.86268202,12.87874746,12.90953669,12.88142494,12.81922178,12.8800862,12.80429148,12.88410238,12.8747312,12.87874746,12.81922178,12.87205365,12.81922178,12.8144795,12.81314041,12.70599017,13.08432726,12.83456501,12.83054803,12.80778398,12.71804684,12.94567573,12.95236757,12.81922178,12.81163393,12.83992087,12.8800862,12.83322602,12.85598778,12.8225139,12.91111495,12.89213455,12.81922178,13.07412756,12.8225139,12.88142494,12.81849673,12.81581859,12.81922178,12.81922178,13.08482887,12.81922178,12.91111495,12.7943924,12.89481188,12.80778398,12.826531,12.80510572,12.8881185,12.94691107,12.95236757,12.72340517,13.01258603,12.83858192,12.84125982,12.83590398,12.86669847,12.81922178,13.08482887,13.01258603,12.96173584,12.82519197,12.91111495,12.91111495,12.87874746,12.7220656,12.83322602,12.90819811,12.79528519,12.91111495,12.8144795,12.79528519,12.73278198,12.89280389,12.83992087,12.93362997,12.85598778,12.73278198,12.86937608,12.74081898,12.93898371,12.82117485,12.95504426,13.01927607,12.81581859,12.72072602,12.8225139,12.87339243,12.83322602,12.84125982,13.01258603,12.94433734,12.826531,12.80644486,12.81922178,12.80778398,13.01258603,12.82787002,12.84039899,13.01258603,12.81922178,12.83188703,12.79528519,12.83188703,12.750296,12.81922178,12.79528519,12.92310291,12.81922178,12.89213455,12.750296,12.81922178,12.87339243,12.79528519,12.8867798,12.79528519,12.750296,12.89481188,12.91111495,12.8747312,12.8854411,12.750296,12.81046221,12.92426063,12.94969086,12.92693762,12.94299894,12.92392601,12.84039899,12.96039754,12.95370592,12.91111495,12.84039899,12.94166054,12.92310291,12.87740872,12.81922178,12.89748918,12.83322602,12.81922178,12.92310291,12.81922178,12.750296,12.7943924,12.91111495,12.91111495,12.81849673,12.89347322,12.77698228,12.83322602,12.90685952,12.91111495,12.89615054,12.81046221,12.94691107,12.79707077,12.8091231,12.8091231,12.82519197,12.94701411,12.750296,12.86803728,12.750296,12.88410238,12.7341215,12.92310291,12.8225139,12.84039899,13.01258603,13.01258603,13.01258603,13.01258603,12.91111495,12.91111495,12.8800862,12.750296,12.73546101,12.91111495,12.84039899,12.83858192,12.81314041,12.92057973,12.71670724,13.07412756,12.73546101,12.9162295,12.72474474,12.86535966,12.91111495,12.73278198,12.80510572,12.97779492,12.8867798,12.73546101,13.03533142,12.81314041,12.89347322,12.83054803,12.94691107,12.8800862,12.89748918,12.94691107,12.83188703,12.81922178,12.9231926,12.83992087,12.84039899,12.80510572,12.91111495,12.81181511,12.84039899,13.04335871,13.04536549,12.91111495,12.72340517,12.94691107,12.91111495,12.73814001,12.94691107,12.750296,12.94691107,12.72474474,12.94691107,12.84039899,12.91111495,12.750296,12.94691107,12.94032213,12.94691107,12.94835249,12.91111495,12.94691107,13.01258603,12.94691107,12.83590398,12.93095305,12.72474474,13.3709154,13.36473601,13.36941232,13.39496338,13.41900896,13.39496338,13.41366571,13.38160369,13.38961959,13.38561167,13.39763523,13.42034476,13.38961959,13.38160369,13.37375452,13.3922915,13.4243521,13.38193769,13.38160369,13.3762596,13.36957933,13.37759563,13.36490303,13.37058138,13.36406796,13.37759563,13.35889051,13.40698647,13.38293969,13.41232987,13.33670084,13.37291949,13.38694765,13.36056067,13.35087358,13.39095555,13.36022663,13.38026768,13.36607211,13.36022663,13.41366571,13.33670084,13.4243521,13.3922915,13.39763523,13.46575736,13.37291949,13.38694765,13.38427568,13.364569,13.40698647,13.42969511,13.39095555,13.37342051,13.38961959,13.40431473,13.38293969,13.36390095,13.37225146,13.36824325,13.38160369,13.38494368,13.39496338,13.45507281,13.46041515,13.38160369,13.36122873,13.36876256,13.42969511,13.36289887,13.4390451,13.36876256,13.36876256,13.3900739,13.36876256,13.3904187,13.36876256,13.36876256,13.4056506,13.38126968,13.33670084,13.33670084,13.38427568,13.41633735,13.36876256,13.457744,13.44572345,13.36423498,13.37074839,13.39095555,13.36223081,13.33670084,13.33670084,13.36356692,13.41767316,13.36306588,13.38694765,13.36289887,13.41366571,13.38761564,13.38961959,13.36957933,13.33670084,13.45373721,13.40431473,13.36306588,13.38143669,13.4243521,13.33670084,13.33670084,13.33670084,13.36256484,13.43637372,13.37893166,13.41099403,13.38895161,13.33670084,13.44705909,13.42969511,13.40164295,13.3762596,13.3922915,13.42702362,13.42034476,13.44171646,13.38193769,13.4337023,13.40965819,13.36690717,13.45907958,13.41366571,13.33670084,13.35621823,13.40297884,13.36490303,13.33670084,13.42969511,13.38093568,13.40431473,13.36423498,13.33670084,13.36876256,13.37425554,12.87740872,12.79144083,12.74483738,12.9162295,12.80242743,12.91087527,12.7394795,12.791714,12.81715766,12.92292213,12.89481188,12.7943924,12.82385294,12.79839949,12.87874746,12.73880975,12.8747312,12.82920903,12.86268202,12.71670724,12.87071487,12.82385294,12.90552092,12.7220656,12.90016646,12.82787002,12.74483738,12.6577578,12.82787002,12.68053534,12.9135524,12.8225139],[-85.72906494,-85.37475586,-85.3692627,-85.35827637,-85.3678894,-85.3678894,-85.36102295,-85.37338257,-85.35690308,-85.35964966,-85.37475586,-85.34179688,-85.36651611,-85.45303345,-85.5519104,-85.57113647,-85.54779053,-85.4750061,-85.23605347,-85.4598999,-85.73335648,-85.2305603,-85.42282104,-85.3692627,-85.36977768,-85.37115097,-85.36977768,-85.3692627,-85.52115499,-85.7359314,-85.73507309,-85.73541641,-85.36960602,-85.73455811,-85.72769165,-85.74279785,-85.73318481,-85.73490143,-85.73541641,-85.72769165,-85.72769165,-85.73181152,-85.72769165,-85.73318481,-85.73455811,-85.73318481,-85.73335648,-85.73558807,-85.73558807,-85.7359314,-85.72769165,-85.73490143,-85.73627472,-85.36994934,-85.73421478,-85.73421478,-85.73043823,-85.73730469,-85.43106079,-85.73181152,-85.3678894,-85.36376953,-85.73421478,-85.48118591,-85.23468018,-85.73541641,-85.73455811,-85.73490143,-85.7314682,-85.73438644,-85.73387146,-85.73318481,-85.73215485,-85.73249817,-85.73232651,-85.3692627,-85.37132263,-85.37063599,-85.37132263,-85.3692627,-85.36840439,-85.35964966,-85.36960602,-85.37029266,-85.36994934,-85.36651611,-85.37200928,-85.37200928,-85.37046432,-85.370121,-85.36891937,-85.37166595,-85.37132263,-85.35552979,-85.37063599,-85.3692627,-85.3692627,-85.36651611,-85.37200928,-85.37063599,-85.52115499,-85.3692627,-85.37063599,-85.37612915,-85.37063599,-85.36651611,-85.37750244,-85.24154663,-85.37218094,-85.35827637,-85.3527832,-85.3692627,-85.3527832,-85.34729004,-85.37046432,-85.370121,-85.3678894,-85.22506714,-85.37475586,-85.34866333,-85.35964966,-85.3692627,-85.45852661,-85.4296875,-85.57800293,-85.59310913,-85.56838989,-85.4914856,-85.60546875,-85.46264648,-85.57765961,-85.42007446,-85.56838989,-85.46539307,-85.52115499,-85.52115499,-85.52115499,-85.52115499,-85.52115499,-85.48324585,-85.36376953,-85.36651611,-85.60249494,-85.37063599,-85.36651611,-85.3692627,-85.36651611,-85.37303925,-85.52115499,-85.37097931,-85.52115499,-85.37063599,-85.52115499,-85.36857605,-85.3678894,-85.4750061,-85.37029266,-85.36943436,-85.7963562,-85.37097931,-85.36994934,-85.52719116,-85.36977768,-85.37029266,-85.36960602,-85.36943436,-85.3692627,-85.37029266,-85.3692627,-85.3678894,-85.36977768,-85.36651611,-85.37115097,-85.72769165,-85.3678894,-85.37029266,-85.3692627,-85.36651611,-85.3692627,-85.7351353,-85.73421478,-85.43243408,-85.21957397,-85.23159027,-85.73181152,-85.24017334,-85.36651611,-85.72494507,-85.21820068,-85.36651611,-85.3692627,-85.7350555,-85.3678894,-85.49423218,-85.22918701,-85.20858765,-85.3692627,-85.36651611,-85.3692627,-85.3678894,-85.3678894,-85.45578003,-85.3678894,-85.36651611,-85.3678894,-85.52115499,-85.36376953,-85.36651611,-85.36651611,-85.52115499,-85.3678894,-85.65353394,-85.19073486,-85.73043823,-85.28137207,-85.46676636,-85.73181152,-85.52115499,-85.43655396,-85.73318481,-85.24841309,-85.42831421,-85.44891357,-85.7510376,-85.46951294,-85.45715332,-85.7351355,-85.71670532,-85.23330688,-85.23605347,-85.71258545,-85.72906494,-85.47912598,-85.71395874,-85.57388306,-85.45715332,-85.48599243,-85.45852661,-85.57594299,-85.54092407,-85.52115499,-85.60249494,-85.45578003,-85.52115499,-85.36960602,-85.72631836,-85.52115499,-85.56544,-85.60249494,-85.52115499,-85.49285889,-85.44204712,-85.73043823,-85.42556763,-85.5494376,-85.7208252,-85.43106079,-85.5495748,-85.48324585,-85.71258545,-85.52115499,-85.43655396,-85.52581787,-85.7351354,-85.7351354,-85.7350955,-85.71395874,-85.52115499,-85.58624268,-85.7350955,-85.37097931,-85.52115499,-85.48324585,-85.72854996,-85.45852661,-85.73730469,-85.50727844,-85.62744141,-85.36994934,-85.37063599,-85.43380737,-85.57662964,-85.55465698,-85.45715332,-85.7194519,-85.72219849,-85.36806107,-85.5655738,-85.57800293,-85.50521851,-85.45303345,-85.5493924,-85.59448242,-85.2305603,-85.64941406,-85.71670532,-85.72219849,-85.7350955,-85.23742676,-85.4914856,-85.43243408,-85.7351355,-85.50109863,-85.49491882,-85.24291992,-85.88150024,-85.88150024,-85.88150024,-85.88150024,-85.88150024,-85.86502075,-85.88150024,-85.88150024,-85.88150024,-85.4598079,-85.45852661,-86.00097656,-85.45166016,-86.00183487,-85.46676636,-86.00131989,-85.597229,-86.00269318,-85.58761597,-85.58624268,-85.45995758,-85.46401978,-85.59036255,-85.6137085,-85.58349609,-85.45578003,-85.45715332,-85.46127319,-85.7359314,-86.00063324,-85.55328369,-86.00097656,-85.45985269,-86.00320816,-85.43380737,-85.61096191,-85.46127319,-86.00269318,-86.00166321,-85.54367065,-85.59997559,-85.46093828,-85.46127319,-85.75241089,-85.56838989,-85.77850342,-86.00252151,-85.47637939,-85.38848877,-85.73919296,-85.60409546,-85.46127319,-85.47637939,-85.46031877,-86.00097656,-85.59997559,-85.45715332,-85.45715332,-85.46676636,-85.4598999,-85.46127319,-85.47637939,-85.81764221,-85.4598999,-86.00097656,-85.46264648,-85.4598999,-85.46539307,-85.4598999,-85.4675052,-85.45852661,-86.00286484,-85.61096191,-85.45440674,-85.45852661,-85.4598999,-85.57388306,-85.58349609,-85.57662964,-85.59757233,-85.80596924,-85.4606765,-85.45578003,-85.60821533,-85.77026367,-85.77713013,-85.87257385,-85.59997559,-85.59036255,-85.73867798,-85.60958862,-85.71670532,-85.44342041,-85.57388306,-85.59448242,-85.5670166,-85.81008911,-85.71670532,-85.71258545,-85.45578003,-85.72906494,-85.46264648,-85.81283569,-85.58349609,-85.45715332,-85.46127319,-85.71395874,-85.45303345,-85.46754502,-85.77713013,-85.71807861,-85.5519104,-85.47637939,-85.79772949,-85.5821228,-85.80871582,-85.57525635,-85.78948975,-85.87257385,-85.45440674,-85.8114624,-85.82794189,-85.40084839,-85.81266403,-85.74691772,-85.79910278,-85.81695557,-85.67962646,-85.8114624,-85.47637939,-85.81695557,-85.46797484,-85.81695557,-85.8114624,-85.81558228,-85.47637939,-85.79360962,-85.47637939,-85.45715332,-85.45715332,-85.57662964,-86.00097656,-85.46264648,-85.46401978,-85.73455811,-85.57800293,-85.70297241,-85.69747925,-85.47637939,-85.76322556,-85.69061279,-85.81008911,-85.78125,-85.77850342,-85.46676636,-85.74932483,-85.80734253,-85.47637939,-85.78399658,-85.45715332,-85.81283569,-85.4598999,-85.45852661,-85.47637939,-85.47637939,-85.7963562,-85.47637939,-85.74932483,-85.67962646,-85.80116272,-85.46127319,-85.68511963,-85.4598999,-85.80322266,-85.71152907,-85.71533203,-85.57388306,-85.94810486,-85.77575684,-85.78125,-85.78399658,-85.80184937,-85.47637939,-85.7963562,-85.9954834,-85.37200928,-85.75790405,-85.74932483,-85.74932483,-85.80322266,-85.58486938,-85.77163696,-85.74211121,-85.69015503,-85.74932483,-85.4598999,-85.69015503,-85.59036255,-85.74211121,-85.77301025,-85.71121216,-85.71258545,-85.59310913,-85.80734253,-85.60546875,-85.74691772,-85.46539307,-85.75927734,-85.66864014,-85.69198608,-85.57388306,-85.68786621,-85.81832886,-85.45852661,-85.77026367,-85.94810486,-85.70983887,-85.75653076,-85.73181152,-85.47637939,-85.73181152,-86.02294922,-85.76065063,-85.77811105,-85.70571899,-85.47637939,-85.77026367,-85.69015503,-85.46127319,-85.63871233,-85.47637939,-85.69015503,-85.76912035,-85.47637939,-85.80047607,-85.63871233,-85.47637939,-85.80184937,-85.69015503,-85.80871582,-85.69015503,-85.63871233,-85.81008911,-85.74932483,-85.8114624,-85.81558228,-85.63871233,-85.73455811,-85.76065063,-85.70159912,-85.76202393,-85.76065063,-85.79223633,-85.77811105,-85.69610596,-85.71121216,-85.74932483,-85.77811105,-85.7510376,-85.76912035,-85.81008911,-85.47637939,-85.80734253,-85.46539307,-85.47637939,-85.76912035,-85.47637939,-85.63871233,-85.67962646,-85.74932483,-85.74932483,-85.45303345,-85.81283569,-85.65490723,-85.71258545,-85.81352234,-85.74932483,-85.80734253,-85.73455811,-85.71152907,-85.71121216,-85.6741333,-85.73318481,-85.68786621,-85.76065063,-85.63871233,-85.73730469,-85.63871233,-85.80322266,-85.597229,-85.76912035,-85.68649292,-85.77811105,-85.94810486,-85.94810486,-85.94810486,-85.94810486,-85.74932483,-85.74932483,-85.80322266,-85.63871233,-85.59379578,-85.74932483,-85.77811105,-85.78125,-85.73867798,-85.8265686,-85.57662964,-85.78399658,-85.59036255,-85.76202393,-85.57662964,-85.83755493,-85.74932483,-85.59585571,-85.72769165,-85.72769165,-85.81420898,-85.60684204,-85.68374634,-85.67825317,-85.80734253,-85.69198608,-85.71152907,-85.73730469,-85.80459595,-85.71152907,-85.76889038,-85.47637939,-85.8377914,-85.77713013,-85.77811105,-85.66864014,-85.74932483,-85.73849201,-85.77811105,-85.7208252,-85.69198608,-85.74932483,-85.59036255,-85.71152907,-85.74932483,-85.61645508,-85.71152907,-85.63871233,-85.71152907,-85.57800293,-85.71152907,-85.77811105,-85.74932483,-85.63871233,-85.71152907,-85.69885254,-85.71152907,-85.72357178,-85.74932483,-85.71152907,-86.06826782,-85.71152907,-85.77438354,-85.76889038,-85.57800293,-85.6288147,-85.67224503,-85.67052841,-85.60821533,-85.61782837,-85.59448242,-85.68511963,-85.67773819,-85.6137085,-85.62194824,-85.65078735,-85.56976318,-85.60684204,-85.64941406,-85.6741333,-85.59860229,-85.71121216,-85.6785965,-85.63705444,-85.64117432,-85.62469482,-85.6741333,-85.66864014,-85.67378998,-85.67121506,-85.63980103,-85.65765381,-85.58898926,-85.63980103,-85.57800293,-85.87257385,-85.65662384,-85.62606812,-85.6688118,-85.6439209,-85.63842773,-85.6288147,-85.6741333,-85.66984177,-85.66314697,-85.60821533,-85.87257385,-85.66452026,-85.56976318,-85.62194824,-85.75653076,-85.65971375,-85.68237305,-85.63842773,-85.67378998,-85.60821533,-85.72906494,-85.62469482,-85.65731049,-85.597229,-85.71258545,-85.66726685,-85.66932678,-85.63156128,-85.6439209,-85.67001343,-85.62950134,-85.5821228,-85.69335937,-85.56427002,-85.67790985,-85.6696701,-85.65307149,-85.55740356,-85.65490723,-85.63293457,-85.65307149,-85.65307149,-85.5713199,-85.91611948,-85.5722095,-85.65307149,-85.65307149,-85.61508179,-85.6785965,-85.87257385,-85.87257385,-85.65078735,-85.61096191,-85.65307149,-85.61645508,-85.59448242,-85.66589355,-85.67361832,-85.60821533,-85.66898346,-85.83618164,-85.87257385,-85.66932678,-85.56015015,-85.67138672,-85.62744141,-85.66726685,-85.57250977,-85.66452026,-85.66452026,-85.65284729,-85.87257385,-85.57388306,-85.58898926,-85.66984177,-85.6794548,-85.63705444,-85.87257385,-85.87257385,-85.87257385,-85.66263199,-85.5670166,-85.64460754,-85.65765381,-85.65490723,-85.87257385,-85.63293457,-85.67001343,-85.63705444,-85.60958862,-85.63156128,-85.57250977,-85.64941406,-85.59310913,-85.67619324,-85.59860229,-85.62057495,-85.67138672,-85.55328369,-85.61782837,-85.87257385,-85.65353394,-85.62744141,-85.66778183,-85.87257385,-85.58486938,-85.67550659,-85.59860229,-85.6710434,-85.87257385,-85.65307149,-85.66520691,-85.25253296,-85.4645897,-85.57250977,-85.3692627,-85.59585571,-85.36651611,-85.58280945,-85.57250977,-85.55740356,-85.27862549,-85.27313232,-85.45578003,-85.54779053,-85.45123716,-85.20172119,-85.56976318,-85.22232056,-85.55465698,-85.37887573,-85.55603027,-85.22644043,-85.55740356,-85.25665283,-85.55740356,-85.26077271,-85.56015015,-85.57594299,-85.53405762,-85.54023743,-85.53817749,-85.34729004,-85.54367065],6,null,"lonlat",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":2,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6},null,null,"<html><head><link rel=\"stylesheet\" type=\"text/css\" href=\"lib/popup/popup.css\"><\/head><body><div class=\"scrollableContainer\"><table class=\"popup scrollable\" id=\"popup\"><tr class='coord'><td><\/td><td><b>Feature ID<\/b><\/td><td align='right'>1&emsp;<\/td><\/tr><tr class='alt'><td>1<\/td><td><b>geometry&emsp;<\/b><\/td><td align='right'>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div><\/body><\/html>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-86.06826782,12.6577578,-85.19073486,13.46575736,"Zoom to lonlat","<strong> lonlat <\/strong>","bottomright"]},{"method":"addLayersControl","args":["OpenTopoMap","lonlat",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["lonlat"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"lonlat","extra":null,"layerId":null,"className":"info legend","group":"lonlat"}]}],"limits":{"lat":[12.6577578,13.46575736],"lng":[-86.06826782,-85.19073486]}},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      //map.on('click', function (e) {\n      //  var txt = document.querySelector('.lnlt').textContent;\n      //  console.log(txt);\n      //  //txt.innerText.focus();\n      //  //txt.select();\n      //  setClipboardText(txt);\n      //});\n\n      function setClipboardText(text){\n      var id = 'mycustom-clipboard-textarea-hidden-id';\n      var existsTextarea = document.getElementById(id);\n\n      if(!existsTextarea){\n      console.log('Creating textarea');\n      var textarea = document.createElement('textarea');\n      textarea.id = id;\n      // Place in top-left corner of screen regardless of scroll position.\n      textarea.style.position = 'fixed';\n      textarea.style.top = 0;\n      textarea.style.left = 0;\n\n      // Ensure it has a small width and height. Setting to 1px / 1em\n      // doesn't work as this gives a negative w/h on some browsers.\n      textarea.style.width = '1px';\n      textarea.style.height = '1px';\n\n      // We don't need padding, reducing the size if it does flash render.\n      textarea.style.padding = 0;\n\n      // Clean up any borders.\n      textarea.style.border = 'none';\n      textarea.style.outline = 'none';\n      textarea.style.boxShadow = 'none';\n\n      // Avoid flash of white box if rendered for any reason.\n      textarea.style.background = 'transparent';\n      document.querySelector('body').appendChild(textarea);\n      console.log('The textarea now exists :)');\n      existsTextarea = document.getElementById(id);\n      }else{\n      console.log('The textarea already exists :3')\n      }\n\n      existsTextarea.value = text;\n      existsTextarea.select();\n\n      try {\n      var status = document.execCommand('copy');\n      if(!status){\n      console.error('Cannot copy text');\n      }else{\n      console.log('The text is now on the clipboard');\n      }\n      } catch (err) {\n      console.log('Unable to copy.');\n      }\n      }\n\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>

---
with 10 common bean varieties

```r
unique(unlist(dt[, paste0("variety_", letters[1:3])]))
```

```
##  [1] "INTA Rojo"          "BRT 103-182"        "ALS 0532-6"        
##  [4] "SJC 730-79"         "INTA Precoz"        "PM2 Don Rey"       
##  [7] "INTA Centro Sur"    "INTA Matagalpa"     "INTA Fuerte Sequia"
## [10] "INTA Ferroso"
```

---
Coerce into rankings using `gosset::rank_tricot()`


```r
R &lt;- rank_tricot(data = dt,
                 items = paste0("variety_", letters[1:3]),
                 input = c("best","worst"))
              

head(R)
```

```
## [1] "INTA Ferroso &gt; PM2 Don Rey &gt; INTA Rojo"  
## [2] "BRT 103-182 &gt; PM2 Don Rey &gt; INTA Mat ..."
## [3] "INTA Ferroso &gt; SJC 730-79 &gt; ALS 0532-6"  
## [4] "INTA Precoz &gt; INTA Centro Sur &gt; INTA ..."
## [5] "INTA Matagalpa &gt; INTA Ferroso &gt; SJC  ..."
## [6] "ALS 0532-6 &gt; INTA Rojo &gt; INTA Centro Sur"
```

---
We can check how these items (varieties are connected) even with partial rankings, we can see that all varieties connect together. This is due to the controlled randomisation performed in `ClimMobTools::randomise()`, when a tricot project is set up


```r
network(R, vertex.size = 30)
```

![](presentation_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;
---
# **Thank you!**
.pull-left[
&lt;img src="img/bioversity.png" width="50%"/&gt;

&lt;img src="img/cgiar-bigdata.png" width="50%"/&gt;

&lt;img src="img/inn-uni.png" width="40%"/&gt;
]

.pull-right[

&lt;img src="https://img.icons8.com/color/64/000000/twitter.png" width = "5%"&gt;[@desousakaue](https://twitter.com/desousakaue)

&lt;img src="https://img.icons8.com/ios-filled/50/000000/email-open.png" width = "5%"&gt;[k.desousa@cgiar.org](mailto:k.desousa@cgiar.org)
]

.footnote[

]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
